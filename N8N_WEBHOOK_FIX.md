# СРОЧНО: Исправление проблемы с ответом на сайте

## Проблема
- В Telegram ответ есть ✅
- На сайте ответа нет ❌
- Пустые заявки летят ❌

## Причина
В n8n workflow ответ отправляется в Telegram, но НЕ возвращается обратно в webhook для сайта.

## Решение

### 1. Проверь ноду "Respond to Webhook"

В n8n workflow должна быть нода **"Respond to Webhook"** которая возвращает ответ обратно.

**Настройки ноды:**
- **Response Mode:** "Using 'Respond to Webhook' Node"
- **Response Data:** JSON
- **Response Body:**
```json
{
  "reply": "{{ $json.reply }}"
}
```

Или если ответ приходит из другой ноды:
```json
{
  "reply": "{{ $json.output.reply }}"
}
```

### 2. Проверь порядок нод

Правильный порядок:
```
Webhook → AI Agent → [обработка] → 
  ├─→ Respond to Webhook (для сайта) ← ЭТО ОБЯЗАТЕЛЬНО!
  └─→ Send Message to Telegram (для Telegram)
```

**ВАЖНО:** Нода "Respond to Webhook" должна быть **ПЕРЕД** отправкой в Telegram, или они должны быть параллельно.

### 3. Проверь что ответ содержит поле "reply"

В ноде "Respond to Webhook" в поле "Response Body" должно быть:
- Либо `{{ $json.reply }}` 
- Либо `{{ $json.output.reply }}`
- Либо `{{ $json[0].reply }}`

Зависит от того, откуда приходит ответ от AI Agent.

### 4. Пустые заявки

Пустые заявки летят потому что:
- Либо есть Error Workflow который отправляет уведомления при ошибках
- Либо есть отдельный workflow для feedback формы который срабатывает неправильно

**Что сделать:**
1. Найди workflow который отправляет "Новая заявка с лендинга"
2. Проверь откуда берутся данные (name, email и т.д.)
3. Добавь проверку: если данные пустые (равны "-") — не отправляй

## Быстрая проверка

1. Открой workflow в n8n
2. Найди ноду "Respond to Webhook"
3. Проверь что она подключена к AI Agent
4. Проверь что в Response Body есть `{{ $json.reply }}` или похожее
5. Сохрани и протестируй

## Если не помогло

Проверь логи в n8n:
- Открой Execution который упал
- Посмотри что возвращает AI Agent
- Проверь что передается в "Respond to Webhook"

